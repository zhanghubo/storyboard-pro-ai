# 🎬 完整工作流程指南

**从文字到视频，三步完成专业分镜创作！**

---

## 🌟 工作流程概览

```
📝 文字大模型          →     🎨 文生图模型          →     🎬 图生视频模型
(必需)                       (推荐)                       (可选)

输入故事描述                  根据提示词生成图片              将图片合成视频
↓                           ↓                           ↓
生成分镜剧本                  批量生成分镜图               输出完整故事板视频
↓                           ↓                           ↓
输出AI绘画提示词              每镜1张高清图                MP4格式，可下载
```

---

## ✅ 第一步：配置文字大模型（必需）

### 作用
- 📝 分析您的故事描述
- 🎭 生成每个分镜的场景、角色、动作
- 🎨 输出结构化的AI绘画提示词

### 如何配置

1. **打开主页**：http://localhost:3000

2. **进入第一步"⚙️ 完整AI配置"**

3. **填写文本生成配置**：
   ```
   选择提供商：OpenAI / Doubao / DeepSeek / Claude 等
   API密钥：你的API Key
   模型名称：gpt-4 / doubao-seed-1-6-lite-251015
   Endpoint ID：（豆包需要）
   ```

4. **点击"🔌 测试连接"**
   - 看到 **🟢 "✓ 连接成功"** 即配置成功

### 支持的模型
- ✅ **OpenAI**：GPT-4, GPT-3.5-turbo
- ✅ **Anthropic**：Claude 3.5 Sonnet
- ✅ **火山引擎**：豆包系列模型
- ✅ **DeepSeek**：DeepSeek-Chat
- ✅ **通义千问**：Qwen 系列
- ✅ **智谱AI**：GLM-4

### 输出结果
```json
{
  "shot": 1,
  "description": "主角站在海边，面对夕阳",
  "characters": "年轻女性，白色连衣裙",
  "environment": "海滩，夕阳西下",
  "action": "回头微笑",
  "emotion": "平静、期待"
}
```

---

## 🎨 第二步：配置文生图模型（推荐）

### 作用
- 🖼️ 根据AI提示词自动生成分镜图片
- 📐 支持 16:9 横版或 9:16 竖版
- 🔢 批量生成 9/15/20 张分镜图

### 如何配置

1. **在第一步配置页面**，找到"图像生成（文生图模型）"区域

2. **勾选"✅ 启用图像生成"**（默认已勾选）

3. **填写图像配置**：
   ```
   选择提供商：Doubao Image / DALL-E 3
   API密钥：你的图像API Key
   Endpoint ID：豆包图像模型的Endpoint
   ```

4. **点击"继续配置"完成设置**

### 支持的模型
- ✅ **火山引擎豆包图像**（推荐）
  - 高质量
  - 价格低（约¥0.08/张）
  - 支持中文提示词
- ✅ **DALL-E 3**
  - OpenAI官方
  - 质量优秀
- ✅ **Stable Diffusion**（计划支持）
- ✅ **Midjourney API**（计划支持）

### 输出结果
- 🖼️ 15个分镜 → 15张高清图片
- 📱 自动适配16:9或9:16比例
- ⬇️ 可单独下载或批量下载

---

## 🎬 第三步：配置图生视频（可选）

### 作用
- 🎥 将所有分镜图片自动合成视频
- ⏱️ 每个分镜3秒（可自定义）
- 🎞️ 添加淡入淡出转场效果
- 📦 输出MP4格式视频

### 如何配置

1. **在第一步配置页面**，找到"视频合成（图生视频模型）"区域

2. **勾选"✅ 启用视频合成"**（默认已勾选）

3. **填写视频配置**：
   ```
   选择提供商：Doubao Video / Runway
   API密钥：你的视频API Key
   Endpoint ID：豆包视频模型的Endpoint
   ```

4. **点击"开始配置"完成所有设置**

### 支持的模型
- ✅ **火山引擎豆包视频**（推荐）
  - 合成速度快
  - 支持多种转场
- ✅ **Runway Gen-2**
- ✅ **Pika Labs**（计划支持）

### 输出结果
- 🎬 完整的故事板视频（MP4格式）
- 📊 15个分镜 × 3秒 = 45秒视频
- 🎵 可后期添加音乐和旁白

---

## 🚀 完整使用流程

### Step 1: 配置所有API（首次使用）

```
1. 访问主页：http://localhost:3000
2. 填写"文本生成"配置 ✅ 必需
3. 勾选并填写"图像生成"配置 ✅ 推荐
4. 勾选并填写"视频合成"配置 ✅ 可选
5. 点击"开始配置"
```

### Step 2: 选择分镜数量

```
选择：9张（3×3）/ 15张（3×5）/ 20张（4×5）
```

### Step 3: 输入故事和风格

```
故事描述：输入你的剧本或故事概要
视觉风格：电影感 / 动漫风格 / 写实风格 等
输出模式：单图模式 / 拼图模式
宽高比：16:9 / 9:16
```

### Step 4: 生成并查看结果

```
📝 正在生成分镜描述... ✅
📐 正在优化分镜布局... ✅
🎨 正在生成AI绘画提示词... ✅
🖼️ 正在生成分镜图片 1/15... ⏳
🎬 正在合成视频... ⏳
✅ 完成！
```

### Step 5: 下载和导出

```
✅ 查看所有分镜图片
✅ 在线播放视频
✅ 下载提示词（Markdown/DOC/JSON）
✅ 下载图片（单张/全部）
✅ 下载视频（MP4）
```

---

## 💡 三种配置模式

### 模式 1：仅生成提示词
**配置**：只填写文字大模型  
**输出**：分镜描述 + AI绘画提示词  
**用途**：导出提示词，在其他平台手动生成图片  
**费用**：¥0.04（15个分镜）

### 模式 2：生成提示词 + 图片（推荐）
**配置**：文字大模型 + 文生图模型  
**输出**：提示词 + 15张高清分镜图  
**用途**：完整的分镜可视化，可直接使用  
**费用**：¥1.24（15个分镜）

### 模式 3：完整流程（文字→图片→视频）
**配置**：文字 + 文生图 + 图生视频  
**输出**：提示词 + 图片 + 完整视频  
**用途**：一键生成可播放的故事板视频  
**费用**：¥23.74（15个分镜）

---

## ❓ 常见问题

### Q1: 为什么只生成了文字，没有图片？

**原因**：没有勾选"启用图像生成"  
**解决**：
1. 点击"重新开始"
2. 在配置页面勾选"✅ 启用图像生成"
3. 填写图像API配置
4. 重新生成

---

### Q2: 图片生成了，但视频失败了？

**原因**：
- 图片数量不足（至少2张）
- 视频API配置错误
- API额度不足

**解决**：
- 图片已经生成，可以直接使用
- 检查视频API配置是否正确
- 确认视频API有足够额度

---

### Q3: 如何只生成图片，不生成视频？

**配置**：
- ✅ 勾选"启用图像生成"
- ❌ 不勾选"启用视频合成"

这样系统只会生成图片，不会调用视频API。

---

### Q4: 在哪里查看生成的图片和视频？

**位置**：
1. 生成完成后，自动进入结果页面
2. 在结果页面可以看到：
   - 🖼️ **图片画廊**：显示所有生成的图片
   - 🎬 **视频播放器**：在线播放生成的视频
   - 📝 **提示词列表**：每个分镜的详细提示词

**操作**：
- 点击图片可以查看大图
- 悬停图片右上角出现下载按钮
- 视频可以直接播放或下载

---

### Q5: 如何获取火山引擎的API密钥？

**步骤**：
1. 访问：https://console.volcengine.com/ark
2. 点击右上角头像 → "API访问密钥"
3. 复制完整的API Key（以`AKLT`开头）

**获取Endpoint ID**：
1. 进入"模型推理"
2. 选择模型（文本/图像/视频）
3. 点击"接入点管理" → 创建接入点
4. 复制Endpoint ID

📖 详细指南：查看项目中的 `API_KEY_GUIDE.md`

---

## 📊 费用参考（火山引擎豆包）

### 15个分镜的成本

| 服务 | 单价 | 数量 | 小计 |
|------|------|------|------|
| 文本生成 | ¥0.002/千tokens | ~20K tokens | ¥0.04 |
| 图像生成 | ¥0.08/张 | 15张 | ¥1.20 |
| 视频合成 | ¥1.5/秒 | 45秒 | ¥22.50 |
| **总计** | - | - | **¥23.74** |

### 不同模式对比

| 模式 | 包含内容 | 费用 | 推荐场景 |
|------|----------|------|----------|
| 仅提示词 | 文字描述 | ¥0.04 | 手动生图 |
| 含图片 | 提示词 + 图片 | ¥1.24 | 大多数场景 ⭐ |
| 完整流程 | 全部 | ¥23.74 | 演示展示 |

---

## 🎯 快速开始

### 1分钟配置（推荐模式）

```bash
# 1. 启动项目（如果未启动）
npm run dev

# 2. 打开浏览器
http://localhost:3000

# 3. 配置API（约30秒）
✅ 填写文字大模型API
✅ 勾选并填写图像生成API
⏸️ 暂不配置视频（可选）

# 4. 生成分镜（约2分钟）
选择 15 个分镜
输入故事描述
点击"生成分镜"
等待完成

# 5. 查看结果
✅ 15个提示词
✅ 15张分镜图
⬇️ 下载所有内容
```

---

## 📚 相关文档

- **`GLASSMORPHISM_GUIDE.md`** - 玻璃形态设计系统指南
- **`API_KEY_GUIDE.md`** - API密钥获取详细教程
- **`FIX_401_ERROR.md`** - 401错误解决方案
- **`QUICK_START.md`** - 5分钟快速开始
- **`DOUBAO_CONFIG.md`** - 火山引擎配置指南

---

## 🔍 在线检查工具

访问工作流程检查页面，验证您的配置：

```
http://localhost:3000/workflow-check
```

这个页面提供：
- ✅ 完整流程图解
- ✅ 逐步配置指南
- ✅ 常见问题解答
- ✅ 费用参考

---

## 💬 需要帮助？

如果遇到问题：

1. **查看检查页面**：http://localhost:3000/workflow-check
2. **阅读相关文档**：项目根目录的 `.md` 文件
3. **检查终端日志**：查看详细的错误信息
4. **测试API连接**：使用配置页面的"测试连接"功能

---

**祝您创作愉快！** 🎬✨

---

**更新时间**：2026-01-02  
**版本**：v2.0  
**完整工作流程支持**：文字 → 图片 → 视频


